(function(exports){"use strict";if(typeof exports==="undefined"){var exports=window}exports.powerButtons=function(e,n=null,t=null){let i=null;let o=[];let s={};function l(e){for(let t in PowerButtons.actionsRegistered){if(e.toLocaleLowerCase()===t.toLocaleLowerCase()){return t}}return null}if(typeof e==="string"){i=l(e);if(i===null){o=document.querySelectorAll(e);if(o.length===0){console.error(`Parameter ${e} is neither the name of a registered plugin nor a valid selector`);return}if(arguments.length>2){console.warn(`Ignoring extra parameters`)}s=n}else{let e=false;if(typeof n==="string"){o=document.querySelectorAll(n);e=true}else if(n instanceof HTMLElement){o=[n];e=true}else if(n.length!==undefined){e=true;for(let t in n){if(!(n[t]instanceof HTMLElement)){e=false;break}}if(e){o=n}}if(!e){console.error(`Parameter ${n} is neither a valid selector, a list of elements or an HTMLElement`);return}s=t}}else if(e instanceof HTMLElement){o=[e]}else if(e.length!==undefined){for(let t in e){if(!(e[t]instanceof HTMLElement)){console.error(`Parameter ${e} is neither a valid selector, a list of elements or an HTMLElement`);return}}o=e}else{console.error(`Parameter ${e} is neither a valid selector, a list of elements or an HTMLElement`);return}if(s===null){s={}}if(typeof s!=="object"){console.error(`Options parameter must be an object`);return}if(i!==null){let e=PowerButtons.actionsRegistered[i];for(let t of o){e.initialize(t,s)}}else{PowerButtons.discover(o,s)}};exports.powerButtons.version="2.2.2";exports.powerButtons.plugins=function(){return Object.keys(PowerButtons.actionsRegistered)};exports.powerButtons.discoverAll=function(){PowerButtons.discoverAll()};exports.powerButtons.discover=function(t,e){PowerButtons.discover(t,e)};if(document.addEventListener!==undefined){document.addEventListener("DOMContentLoaded",function(t){PowerButtons.discoverAll()})}if(exports.$!==undefined){exports.$.fn.powerButtons=function(t,e={}){exports.powerButtons(t,this,e);return this};exports.$.fn.powerButtons.version=exports.powerButtons.version;exports.$.fn.powerButtons.plugins=exports.powerButtons.plugins}function pascalToSnake(t){return t.replace(/[A-Z]/g,t=>`_${t.toLowerCase()}`).replace(/^_*/,"")}function pascalToKebab(t){return t.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`).replace(/^-*/,"")}function snakeCaseToCamel(t){return t.replace(/-([a-z])/g,t=>t[1].toUpperCase())}function pascalToCamel(t){return t.charAt(0).toLowerCase()+t.slice(1)}function CamelToCamel(t){return t.charAt(0).toUpperCase()+t.slice(1)}function isElement(t){return t instanceof Element||t instanceof HTMLDocument}function parseBoolean(t){if(typeof t==="boolean"){return t}if(typeof t==="string"){t=t.toLowerCase();if(t==="true"||t==="yes"||t==="1"){return true}return false}return!!t}function createTag(t,e={},n=null){let i=t.split("#");let o=null;if(i.length==1){t=i[0]}else{i[1]=i[1].split(".");o=i[1][0];t=[i[0],...i[1].slice(1)].join(".")}let s=t.split(".");t=s[0];if(t===""){t="div"}if(typeof e==="string"){n=e;e={}}if(n!==null){e.innerHTML=n}if(o!==null){e.id=o}e.className=[e.className,...s.slice(1)].filter(function(t){return`${t}`.trim()!==""}).join(" ");let l=document.createElement(t);for(let t in e){if(l[t]!==undefined){l[t]=e[t]}else{l.setAttribute(t,e[t])}}return l}function appendToElement(t,...e){let n=e.filter(t=>t!==null&&t!==undefined);t.append(...n);return t}function searchForm(t){let e=null;if(t!==null){e=document.forms[t];if(e===undefined){e=document.querySelector(t);if(e===null){console.warn(`form ${t} not found`)}}}if(e!==null){if(e.tagName.toLowerCase()!=="form"){console.warn(`form ${t} is not a form`)}}return e}function getValueWithJavascriptSupport(value,context=null){if(typeof value==="function"){return value.bind(context)}if(typeof value==="string"){let internalValue=value.trim();if(internalValue.startsWith("javascript:")){try{let f=internalValue.substring(11);value=function(){return eval(f)}.bind(context)}catch(e){console.error(`Error executing javascript code ${internalValue.substring(11)}, error: ${e}`);value=null}}}return value}function promiseForEvent(t,e){if(t===null||t===undefined){return Promise.resolve()}let n=null;let i=new Promise(t=>{n=t});let o=function(){t.removeEventListener(e,o);n()};t.addEventListener(e,o);return i}function isEmpty(t){if(t===null||t===undefined){return true}if(t instanceof Array){return t.length===0}if(t instanceof Object){return Object.keys(t).length===0}if(typeof t==="string"){return t.trim()===""}return false}class DialogLegacy{DEFAULTS={message:"Main message",buttonCount:2};constructor(t={},e=null,n=null){this.options={...this.DEFAULTS,...t};this.buttonCount=this.options.buttons.length;this.options.buttons=["Accept","Cancel"];this.result=null;this.onButton=e;this.onHidden=n}dispose(){}show(t=null,e=null){if(t!==null){this.onButton=t}if(e!==null){this.onHidden=e}switch(this.buttonCount){case 0:case 1:alert(this.message);this.result=0;break;case 2:this.result=confirm(this.options.message)?0:1;break;default:throw`Unsupported button count ${this.buttonCount}`}if(this.onButton!==null){this.onButton(this.result,{button:this.result,text:this.options.buttons[this.result]},null)}if(this.onHidden!==null){this.onHidden(this.result,{button:this.result,text:this.options.buttons[this.result]},null)}}}class Dialog{static create(t={},e=null,n=null){if(exports.bootstrap===undefined||exports.bootstrap.Modal===undefined){return new DialogLegacy(t,e,n)}if(t.selector!==undefined&&t.selector!==null||t.dialogFunction!==undefined&&t.dialogFunction!==null){throw new Error("not implemented, yet")}return new Dialog(t,e,n)}DEFAULTS={title:"Title",message:"Main message",customContent:null,buttons:["Accept"],buttonClasses:["btn-primary","btn-secondary"],buttonPanelClasses:["text-end"],escapeKeyCancels:true,header:true,footer:true,body:true,close:true,dialogClass:"fade",focus:"",onDialogCreated:t=>{}};dialog=null;options=null;modal=null;result=null;onHidden=null;onButton=null;buttons=[];constructor(t={},e=null,n=null){if(exports.bootstrap===undefined||exports.bootstrap.Modal===undefined){throw new Error("Bootstrap is required to use this class")}this.options={...this.DEFAULTS,...t};let i=[];for(let e=0;e<this.options.buttons.length;e++){let t=this.options.buttons[e];if(typeof t==="string"){t={text:t}}else{if(t.text===undefined){t.text=`Button ${e}`}}if(t.class===undefined){t.class=this.options.buttonClasses[Math.min(e,this.options.buttonClasses.length-1)]}i.push(t)}this.options.buttons=i;this.dialog=null;this.buttons=[];this.modal=null;this.result=null;this.onButton=e;this.onHidden=n;this._hiddenHandler=this._hiddenHandler.bind(this);this._hideHandler=this._hideHandler.bind(this)}_hiddenHandler(){this.dialog.removeEventListener("hidden.bs.modal",this._hiddenHandler);if(this.onHidden!==null){if(this.result!==null&&this.result>=0){this.onHidden(this.result,{button:this.result,text:this.options.buttons[this.result]})}else{this.onHidden(this.result,null)}}this.dispose()}_hideHandler(){this.dialog.removeEventListener("hide.bs.modal",this._hideHandler);if(document.activeElement){document.activeElement.blur()}}dispose(){if(this.modal!==null){this.modal.dispose();this.modal=null}this.dialog.remove();this.dialog=null;this.buttons=[]}show(onButton=null,onHidden=null){if(this.dialog===null){let dialog=this._build_dialog(this.options);this.dialog=dialog.dialog;this.buttons=dialog.buttons;document.body.append(this.dialog);if(this.options.onDialogCreated!==null){if(typeof this.options.onDialogCreated==="function"){this.options.onDialogCreated(this.dialog)}else if(typeof this.options.onDialogCreated==="string"){eval(this.options.onDialogCreated)}}}if(this.modal===null){this.modal=new bootstrap.Modal(this.dialog,{backdrop:this.options.escapeKeyCancels?true:"static",keyboard:this.options.escapeKeyCancels})}this.dialog.addEventListener("hidden.bs.modal",this._hiddenHandler);this.dialog.addEventListener("hide.bs.modal",this._hideHandler);this.result=null;if(onButton!==null){this.onButton=onButton}if(onHidden!==null){this.onHidden=onHidden}this.modal.show();return promiseForEvent(this.dialog,"shown.bs.modal").then(()=>{if(this.options.focus!==""){this.dialog.querySelector(this.options.focus)?.focus()}})}hide(){if(this.modal===null){return new Promise(t=>{t()})}this.modal.hide();return promiseForEvent(this.dialog,"hidden.bs.modal")}_handleButton(t,e,n){this.result=t;let i=true;if(this.onButton!==null){i=!(this.onButton(t,e,n)===false)}if(i){this.hide()}}_build_dialog(o={}){let t=null;let e=null;if(parseBoolean(o.close)){e=createTag("button.close.btn-close",{tabindex:"-1",type:"button","aria-label":"Close"});e.addEventListener("click",()=>this._handleButton(-1,null,e))}if(parseBoolean(o.header)){t=createTag(".modal-header");if(o.title!==null){t.append(appendToElement(createTag(".modal-title"),appendToElement(createTag("h5",o.title))))}if(parseBoolean(o.close)){t.append(e)}}let s=[];if(o.buttons!==null){for(let i=0;i<o.buttons.length;i++){let t=o.buttons[i];let e=t.class.split(" ").map(t=>t.trim()).filter(t=>t!=="").join(".");if(o.footer===false){e+=".mx-1"}if(e!==""){e="."+e}let n=createTag("button.btn"+e+".button"+i,{type:"button",tabindex:i+1},t.text);n.addEventListener("click",function(){this._handleButton(i,t,n);if(t.handler!==undefined&&t.handler!==null){t.handler(i,t,n)}}.bind(this));s.push(n)}}let n=null;if(parseBoolean(o.footer)){n=appendToElement(createTag(".modal-footer"),...s)}let i=null;if(parseBoolean(o.body)){i=createTag(".modal-body");if(t===null){if(parseBoolean(o.close)){i.append(appendToElement(createTag(".text-end"),e))}}if(o.message!==null){i.append(createTag("p.message.text-center",o.message))}if(o.customContent!==null){i.append(createTag(".custom-content.mx-auto",o.customContent))}if(n===null){let t=o.buttonPanelClasses.map(t=>t.trim()).filter(t=>t!=="").join(".");if(t!==""){t="."+t}appendToElement(i,appendToElement(createTag(".buttons"+t),...s))}}let l=o.dialogClass.split(" ").map(t=>t.trim()).filter(t=>t!=="").join(".");if(l!==""){l="."+l}let r=appendToElement(createTag(l+".modal.draggable",{tabindex:"-1",role:"dialog","aria-hidden":"true","data-keyboard":"false"}),appendToElement(createTag(".modal-dialog.modal-dialog-centered",{role:"document"}),appendToElement(createTag(".modal-content"),t,i,n)));return{dialog:r,buttons:s}}}function confirmDialog(t,e="this action needs confirmation",n=null,i=null,o=true){let s=new Dialog({title:e,message:t,buttons:[{text:"Cancel",class:"btn-secondary",handler:i},{text:"Confirm",class:"btn-primary",handler:n}],escapeKeyCancels:o});s.show();return s}function alertDialog(t,e="Alert",n=null){let i=new Dialog({title:e,message:t,buttons:[{text:"Accept",class:"btn-primary",handler:n}],escapeKeyCancels:true});i.show();return i}function loadingDialog(t,e=null,n=null){if(typeof e==="function"){n=e;e=null}let i=new Dialog({title:null,message:t,buttons:[{text:"Cancel",class:"btn-primary"}],customContent:e,escapeKeyCancels:false,close:false,header:false,footer:false},n);i.show();return i}if(exports.powerButtons.utils===undefined){exports.powerButtons.utils={}}Object.assign(exports.powerButtons.utils,{confirmDialog:confirmDialog,alertDialog:alertDialog,loadingDialog:loadingDialog,Dialog:Dialog});class PowerButtons{static actionsRegistered={};static registerAction(t){this.actionsRegistered[t.NAME.toLowerCase()]=t;if(exports.powerButtons===undefined){exports.powerButtons={}}if(exports.powerButtons.defaults===undefined){exports.powerButtons.defaults={}}exports.powerButtons.defaults[t.NAME.toLowerCase()]=Object.assign({},t.DEFAULTS)}static getActionSettings(t,e){if(this.actionsRegistered[t.NAME.toLowerCase()]===undefined){console.error(`The action ${t.NAME} is not registered`);return{}}let n={};if(exports.powerButtons!==undefined&&exports.powerButtons.defaults!==undefined&&exports.powerButtons.defaults[t.NAME.toLowerCase()]!==undefined){n=exports.powerButtons.defaults[t.NAME.toLowerCase()]}return Object.assign({},t.DEFAULTS,n,e)}static addAction(t,e={}){let n=PowerButtons.addActionSupport(t);n.appendAction(e)}static addActionSupport(t){if(t._powerButtons===undefined){t._powerButtons=new PowerButtons(t)}else{t._powerButtons.reset()}return t._powerButtons}el=null;current_action=0;actions=[];back_onclick=null;constructor(t){t._powerButtons=this;this.el=t;this.current_action=0;this.actions=[];this.back_onclick=null;if(t.onclick!==undefined&&t.onclick!==null){this.back_onclick=t.onclick;t.onclick=null}t.addEventListener("click",this.handlerClick.bind(this))}appendAction(t={}){if(t.type===undefined){throw"The type of the action is mandatory"}this.actions.push(t)}handlerClick(e){if(this.current_action>=this.actions.length){this.current_action=0;if(typeof this.back_onclick==="function"){if(!this.back_onclick()){e.preventDefault()}}return}let t=this.actions[this.current_action];e.preventDefault();e.stopImmediatePropagation();let n=function(t=false){if(t){this.current_action=this.actions.length}else{this.current_action++}if(this.current_action>=this.actions.length){if(this.el.click!==undefined){this.el.click()}else{this.el.dispatchEvent(new Event(e.type,e))}}else{this.el.dispatchEvent(new Event(e.type,e))}}.bind(this);let i=this.constructor.actionsRegistered[t.type];if(i===undefined){throw`The action ${t.type} is not registered`}i.execute(this.el,t,n,()=>this.reset())}reset(){this.current_action=0}static discoverAll(){Object.entries(this.actionsRegistered).forEach(([t,e])=>{e.discoverAll()})}static discover(n,i={}){Object.entries(this.actionsRegistered).forEach(([t,e])=>{e.discover(n,i)})}}class Action{static NAME=null;static register(){PowerButtons.registerAction(this)}static DEFAULTS={};static extractOptions(n,i=null,o=null){if(i===null){i=this.NAME.toLowerCase()}if(o===null){o={};o[i]=i}let s={};for(let e in this.DEFAULTS){let t=e;if(o[t]!==undefined){t=o[t]}else{t=i+CamelToCamel(t)}if(n.dataset[t]!==undefined){s[e]=n.dataset[t]}}return s}static initialize(t,e={}){PowerButtons.addAction(t,Object.assign({type:this.NAME.toLowerCase()},e))}static discoverAll(){let t=this.NAME.toLowerCase();this.discover(document.querySelectorAll(`[data-${t}]`))}static discover(t,n={},i=true){if(t.length===undefined){t=[t]}let o=this.NAME.toLowerCase();for(let e of t){if(i&&e._powerButtons!==undefined&&e._powerButtons._discover!==undefined&&e._powerButtons._discover.indexOf(o)!==-1){continue}if(e.dataset[o]===undefined){continue}let t=Object.assign(this.extractOptions(e,o),n);this.initialize(e,t);if(e._powerButtons!==undefined){if(e._powerButtons._discover===undefined){e._powerButtons._discover=[]}if(!e._powerButtons._discover.includes(o)){e._powerButtons._discover.push(o)}}}}static execute(t,e,n,i){throw new Error("The execute method must be implemented by the derived class")}}class ActionOverride extends Action{static NAME="Override";static DEFAULTS={override:null,form:null,overridden:null,customContent:null,title:null,buttonAccept:"Accept",escapeKey:true,dialogClass:"fade",focus:"",onDialogCreated:t=>{}};static execute(el,options,onNextAction,onCancelActions){let settings=PowerButtons.getActionSettings(this,options);let result=null;let bindObject=searchForm(settings.form);if(bindObject===null){bindObject=document}try{if(typeof settings.override==="function"){result=settings.override.bind(bindObject)()}else if(typeof settings.override==="string"){result=function(){return eval(settings.override)}.bind(bindObject)()}else{result=parseBoolean(settings.override)}}catch(e){console.error("Error executing override function",e);result=false}if(result){if(settings.overridden!==null||settings.customContent!==null||settings.title!==null){let dialog=null;dialog=Dialog.create({title:settings.title,message:settings.overridden,customContent:settings.customContent,buttons:[settings.buttonAccept],escapeKeyCancels:settings.escapeKey,close:settings.buttonClose,dialogClass:settings.dialogClass,focus:settings.focus,onDialogCreated:settings.onDialogCreated},null,function(t){onNextAction(true)});dialog.show()}else{onNextAction(true)}}else{onNextAction()}}}ActionOverride.register();class ActionVerify extends Action{static NAME="Verify";static DEFAULTS={verify:null,form:null,verified:null,notVerified:"The condition for this action is not met",customContentVerified:null,customContentNotVerified:null,titleNotVerified:"The action requires verification",titleVerified:null,buttonAccept:"Accept",buttonClose:false,escapeKey:true,dialogClass:"fade",focus:"",onDialogCreated:t=>{}};static execute(el,options,onNextAction,onCancelActions){let settings=PowerButtons.getActionSettings(this,options);let result=null;let bindObject=searchForm(settings.form);if(bindObject===null){bindObject=document}try{if(typeof settings.verify==="function"){result=settings.verify.bind(bindObject)()}else if(typeof settings.verify==="string"){result=function(){return eval(settings.verify)}.bind(bindObject)()}else{result=parseBoolean(settings.verify)}}catch(e){console.error("Error executing verification function",e);result=false}let dialog=null;let onVerificationSuccess=onNextAction;let onVerificationFailure=onCancelActions;if(result){if(settings.verified!==null||settings.customContentVerified!==null||settings.titleVerified!==null){dialog=Dialog.create({title:settings.titleVerified,message:settings.verified,customContent:settings.customContentVerified,buttons:[settings.buttonAccept],escapeKeyCancels:settings.escapeKey,close:settings.buttonClose,dialogClass:settings.dialogClass,focus:settings.focus,onDialogCreated:settings.onDialogCreated},null,function(t){if(onVerificationSuccess!==null){onVerificationSuccess()}})}}else{if(settings.notVerified!==null||settings.customContentNotVerified!==null||settings.titleNotVerified!==null){dialog=Dialog.create({title:settings.titleNotVerified,message:settings.notVerified,customContent:settings.customContentNotVerified,buttons:[settings.buttonAccept],escapeKeyCancels:settings.escapeKey,close:settings.buttonClose,dialogClass:settings.dialogClass,focus:settings.focus,onDialogCreated:settings.onDialogCreated},null,function(t){if(onVerificationFailure!==null){onVerificationFailure()}})}}if(dialog!==null){dialog.show()}else{if(result){if(onVerificationSuccess!==null){onVerificationSuccess()}}else{if(onVerificationFailure!==null){onVerificationFailure()}}}}}ActionVerify.register();class ActionConfirm extends Action{static NAME="Confirm";static DEFAULTS={confirm:"Please confirm this action",customContent:null,title:"The action requires confirmation",buttonConfirm:"Confirm",buttonCancel:"Cancel",buttonClose:true,onConfirm:null,escapeKey:true,dialogClass:"fade",focus:"",onDialogCreated:t=>{}};static extractOptions(t,e=null,n=null){let i=super.extractOptions(t,e,n);if(i.confirm.trim()==""){delete i.confirm}return i}static execute(el,options,onNextAction,onCancelActions){let settings=PowerButtons.getActionSettings(this,options);let dialog=Dialog.create({title:settings.title,message:settings.confirm,customContent:settings.customContent,buttons:[settings.buttonConfirm,settings.buttonCancel],escapeKeyCancels:settings.escapeKey,close:settings.buttonClose,dialogClass:settings.dialogClass,focus:settings.focus,onDialogCreated:settings.onDialogCreated},null,function(result){if(result===0){if(settings.onConfirm!==null){let result=null;if(typeof settings.onConfirm==="function"){result=settings.onConfirm.bind(document)()}else if(typeof settings.onConfirm==="string"){result=function(){return eval(settings.onConfirm)}.bind(document)()}}if(onNextAction!==null){onNextAction()}}else{if(onCancelActions!==null){onCancelActions()}}});dialog.show()}}ActionConfirm.register();class ActionAsyncTask extends Action{static NAME="AsyncTask";static DEFAULTS={task:null,message:"Please wait...",customContent:null,title:null,buttonCancel:"Cancel",cancel:null,header:true,footer:true,dialogClass:"fade",focus:"",onDialogCreated:t=>{}};static extractOptions(t,e=null,n=null){return super.extractOptions(t,e,{task:"asynctask"})}static execute(el,options,onNextAction,onCancelActions){let settings=PowerButtons.getActionSettings(this,options);if(settings.task===null){console.error("The task to execute cannot be null");return}let task=null;if(typeof settings.task==="string"){task=async function(){return await eval(settings.task)}}else if(typeof settings.task==="function"){task=settings.task}else{console.error("The task to execute must be either a string or a function");return}let buttons=[];let cancelHandler=null;if(settings.cancel!==null){buttons=[settings.buttonCancel];if(typeof settings.cancel==="string"){cancelHandler=function(){eval(settings.cancel)}}else if(typeof settings.cancel==="function"){cancelHandler=settings.cancel}else{console.error("The cancel handler must be either a string or a function")}}let dialog=Dialog.create({title:settings.title,message:settings.message,customContent:settings.customContent,buttons:buttons,escapeKeyCancels:false,close:false,header:options.header!==undefined?settings.header:settings.title!==null&&settings.title!="",footer:options.footer!==undefined?settings.footer:cancelHandler!==null,dialogClass:settings.dialogClass,focus:settings.focus,onDialogCreated:settings.onDialogCreated},function(){cancelHandler();onCancelActions()},function(t){if(onNextAction!==null){onNextAction()}});dialog.show().then(function(){task().finally(function(){dialog.hide()})})}}ActionAsyncTask.register();class ActionShowMessage extends Action{static NAME="ShowMessage";static DEFAULTS={showmessage:"This is a message",customContent:null,title:null,buttonAccept:"Accept",escapeKey:true,buttonClose:true,header:true,footer:true,dialogClass:"fade",focus:"",onDialogCreated:t=>{}};static execute(t,e,n,i){let o=PowerButtons.getActionSettings(this,e);let s=Dialog.create({title:o.title,message:o.showmessage,customContent:o.customContent,buttons:[o.buttonAccept],escapeKeyCancels:o.escapeKey,close:o.buttonClose,header:e.header!==undefined?o.header:o.title!==null&&o.title!="",footer:e.footer!==undefined?o.footer:o.buttonAccept!==null&&o.buttonAccept!="",dialogClass:o.dialogClass,focus:o.focus,onDialogCreated:o.onDialogCreated},null,function(t){if(n!==null){n()}});s.show()}}ActionShowMessage.register();class ActionFormset extends Action{static NAME="Formset";static DEFAULTS={form:null,fields:{}};static extractOptions(n,i=null,t=null){let e=super.extractOptions(n,i,{form:"formset"});let o={};for(let e in n.dataset){if(e.startsWith(i)){let t=e.substring(i.length);if(t===""){continue}if(t[0]!==t[0].toUpperCase()){continue}t=t.toLocaleLowerCase();o[t]=n.dataset[e]}}if(e.fields===undefined){e.fields={}}Object.assign(e.fields,o);return e}static execute(t,e,n,i){let o=PowerButtons.getActionSettings(this,e);let s=null;let l=[];let r=[];if(o.form==""){if(t.form!==null){s=t.form}else{r=Array.from(document.querySelectorAll("input")).filter(t=>t.form===null)}}else{s=searchForm(o.form);if(s===null){console.error(`Form not found ${o.form}`);return}}if(s!==null){r=Array.from(s.elements)}r.forEach(t=>{if(t.name!==""){l[t.name.toLocaleLowerCase()]=t}if(t.id!==""){l[t.id.toLocaleLowerCase()]=t}});for(let n in o.fields){if(l[n]!==undefined){let e=o.fields[n];let t=getValueWithJavascriptSupport(e,s!==null?s:l);if(typeof t==="function"){try{t=t()}catch(t){console.error(`Error executing ${e}`,t);continue}}l[n].value=t}}n()}}ActionFormset.register();class ActionFormButton extends Action{static NAME="FormButton";static DEFAULTS={formbutton:null,method:"post",formClass:"formbutton",convertCase:"none",formId:null,fields:{}};static extractOptions(n,i=null,t=null){let o=super.extractOptions(n,i,t);let s={};i=i+"Field";for(let e in n.dataset){if(e.startsWith(i)){let t=e.substring(i.length);if(t===""){continue}if(t[0]!==t[0].toUpperCase()){continue}switch(o.convertCase){case"kebab":t=pascalToKebab(t);break;case"snake":t=pascalToSnake(t);break;case"camel":t=pascalToCamel(t);break;case"pascal":break}s[t]=n.dataset[e]}}if(o.fields===undefined){o.fields={}}Object.assign(o.fields,s);return o}static initialize(t,e={}){let n=PowerButtons.getActionSettings(this,e);let i=document.createElement("form");i.method=n.method;if(!isEmpty(n.formbutton)){i.action=n.formbutton}if(n.formId!==null){i.id=n.formId}let o=n.formClass.split(" ");for(var s=0;s<o.length;s++){if(!isEmpty(o[s])){i.classList.add(o[s])}}t.type="submit";let l={};for(let t in n.fields){l[t]=getValueWithJavascriptSupport(n.fields[t],i)}let r={};for(let e in l){let t=document.createElement("input");t.type="hidden";t.name=e;if(typeof l[e]==="function"){t.value="";r[e]=l[e]}else{t.value=l[e]}i.appendChild(t)}t.parentNode.replaceChild(i,t);i.appendChild(t);if(Object.keys(r).length>0){n.fields=r;n._formObject=i;super.initialize(t,n)}}static execute(t,e,n,i){let o=PowerButtons.getActionSettings(this,e);let s=false;for(let e in o.fields){try{let t=o.fields[e]();o._formObject[e].value=t}catch(t){console.error(`Error obtaining value for field ${e}: ${t}`);s=true}}if(s){i()}else{n()}}}ActionFormButton.register()})(window);